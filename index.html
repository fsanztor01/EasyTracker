<!DOCTYPE html>
<html lang="es" data-theme="dark">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>EasyTracker</title>
    <link rel="stylesheet" href="EasyTracker.css">
</head>

<body>
    <!-- MAIN APPLICATION -->
    <div id="mainApp">
        <main class="container fade-in" id="main">
            <!-- DIARIO -->
            <section class="panel" id="panel-diary" role="tabpanel" aria-labelledby="tab-diary" aria-hidden="false">
                <div class="weekbar">
                    <button class="btn btn--ghost" id="prevWeek" aria-label="Semana anterior"><span>‚óÄ</span></button>
                    <div class="week-info" id="weekInfo">Semana actual</div>
                    <button class="btn btn--ghost" id="nextWeek" aria-label="Semana siguiente"><span>‚ñ∂</span></button>
                </div>

                <div class="diary-actions">
                    <button class="btn" id="btnNewSession">+ Nueva sesi√≥n</button>
                    <button class="btn btn--clear-week" id="btnClearWeek" aria-label="Limpiar semana">
                        <span style="color:var(--danger, #ff4444)">‚úï</span> Limpiar semana
                    </button>
                </div>

                <article class="summary card pop" aria-labelledby="summaryTitle">
                    <h2 class="summary__title" id="summaryTitle">Resumen semanal</h2>
                    <div class="summary__grid">
                        <div class="kpi">
                            <div class="kpi__label">Sesiones</div>
                            <div class="kpi__value" id="kpiSessions">0</div>
                        </div>
                        <div class="kpi">
                            <div class="kpi__label">Ejercicio con m√°s progreso</div>
                            <div class="kpi__value" id="kpiTop">‚Äì</div>
                        </div>
                        <div class="kpi">
                            <div class="kpi__label">Volumen total</div>
                            <div class="kpi__value" id="kpiVolume">0 kg</div>
                        </div>
                        <div class="kpi">
                            <div class="kpi__label">RIR promedio</div>
                            <div class="kpi__value" id="kpiRIR">‚Äì</div>
                        </div>
                    </div>
                </article>

                <section class="sessions" id="sessions" aria-live="polite"></section>
                <div class="empty card pop" id="emptyState" hidden>
                    <div aria-hidden="true" style="font-size:1.6rem">üìù</div>
                    <h3 style="margin:0">No hay entrenos esta semana</h3>
                    <p style="margin:0">Crea una sesi√≥n o importa una plantilla.</p>
                </div>
            </section>

            <!-- ESTADISTICAS -->
            <section class="panel" id="panel-stats" role="tabpanel" aria-labelledby="tab-stats" aria-hidden="true">
                <!-- Filtros compartidos -->
                <article class="card pop" style="padding:12px; margin-bottom:10px; margin-top:10px">
                    <h3 class="summary__title" style="margin-bottom:10px">Filtros</h3>
                    <div class="chart-controls">
                        <div class="chart-control-group">
                            <label class="chart-control-label" for="sharedMetric">M√©trica</label>
                            <select id="sharedMetric" class="chart-select" aria-label="Selecciona m√©trica">
                                <option value="volume">Volumen total</option>
                                <option value="rir">RIR promedio</option>
                                <option value="weight">Peso m√°ximo</option>
                            </select>
                        </div>
                        <div class="chart-control-group">
                            <label class="chart-control-label" for="sharedExercise">Ejercicio</label>
                            <div class="exercise-search-wrapper">
                                <input type="text" id="sharedExercise" class="exercise-search-input"
                                    placeholder="Todos los ejercicios" aria-label="Buscar ejercicio"
                                    autocomplete="off" />
                                <span class="exercise-search-icon">üîç</span>
                                <div id="exerciseSuggestions" class="exercise-suggestions" style="display: none;"></div>
                            </div>
                        </div>
                        <div class="chart-control-group">
                            <label class="chart-control-label" for="sharedPeriod">Periodo</label>
                            <select id="sharedPeriod" class="chart-select" aria-label="Selecciona periodo de semanas">
                                <option value="4" selected>√öltimas 4 semanas</option>
                                <option value="8">√öltimas 8 semanas</option>
                                <option value="12">√öltimas 12 semanas</option>
                            </select>
                        </div>
                    </div>
                </article>

                <!-- Aggregated Circular Chart (All Exercises) -->
                <article class="card pop" id="aggregatedChartContainer" style="padding:16px; margin-top:10px; margin-bottom:10px; position: relative;">
                    <button type="button" id="weekInfoBtn" class="btn" style="position: absolute; top: 12px; right: 12px; min-width: 36px; height: 36px; padding: 0; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; z-index: 10; background: var(--card-bg, rgba(255,255,255,0.1)); border: 1px solid var(--border, rgba(255,255,255,0.2));" title="Informaci√≥n de semanas">
                        üìà
                    </button>
                    <div id="aggregatedCircularChart" class="aggregated-circular-chart"></div>
                </article>

                <!-- Ciclos archivados -->
                <article class="card pop" style="padding:12px; margin-top:10px; margin-bottom:10px">
                    <h3 class="summary__title" style="margin-bottom:10px">Gesti√≥n de Ciclos</h3>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                        <button class="btn btn--archive-cycle" id="archiveCycleBtn" type="button">üì¶ Archivar Ciclo
                            Actual</button>
                        <div id="archivedCyclesList" style="display: flex; gap: 8px; flex-wrap: wrap;"></div>
                    </div>
                </article>

                <!-- Contenedor para lista de ejercicios (cuando "Todos los ejercicios" est√° seleccionado) -->
                <article class="card pop" id="statsListContainer" style="padding:16px; margin-top:10px; display:none;">
                    <div id="statsExerciseList" class="stats-exercise-list"></div>
                </article>

                <!-- Contenedor para gr√°fico circular (cuando un ejercicio espec√≠fico est√° seleccionado) -->
                <article class="card pop" id="statsChartContainer" style="padding:16px; margin-top:10px; display:none;">
                    <div id="statsCircularChart" class="stats-circular-chart"></div>
                    <div id="statsChartDetails" class="stats-chart-details"></div>
                </article>
            </section>

            <!-- RUTINAS -->
            <section class="panel" id="panel-routines" role="tabpanel" aria-labelledby="tab-routines"
                aria-hidden="true">
                <div class="routine-panel">
                    <!-- Title -->
                    <h2 class="summary__title routines-section-title" style="margin-bottom: 16px; font-size: 1.3rem;">Mis rutinas</h2>
                    
                    <!-- Import/Export Management -->
                    <button class="btn btn--ghost routines-import-btn" id="btnGoToImport" style="width: 100%; padding: 12px; min-height: 44px; font-size: 0.95rem; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; background: rgba(100, 100, 110, 0.15); border: 1px solid var(--border);">
                        <span>üìÅ</span>
                        <span>Gesti√≥n de Importaci√≥n/Exportaci√≥n</span>
                    </button>
                    
                    <!-- Create New Routine Button -->
                    <button class="btn" id="btnCreateNewRoutine" style="width: 100%; padding: 14px; min-height: 48px; font-size: 1rem; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <span style="font-size: 1.2rem;">+</span>
                        <span>Crear nueva rutina</span>
                    </button>
                    
                    <!-- Routine Builder (Hidden by default) -->
                    <article class="card pop routine-builder-card" id="routineBuilderCard" style="display: none; padding: 16px; margin-bottom: 16px;">
                        <div class="field" style="margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px;">
                                <label class="label" for="routineName" style="margin: 0; font-size: 0.9rem;">Nombre (opcional)</label>
                                <button type="button" class="btn btn--ghost" id="closeRoutineBuilder" style="padding: 8px; min-height: 36px; min-width: 36px; font-size: 1.1rem; color: var(--muted); cursor: pointer; z-index: 10; position: relative;" aria-label="Cerrar constructor de rutina" title="Cerrar">‚úï</button>
                            </div>
                            <input id="routineName" class="input" placeholder="Ej. Fuerza 4 d√≠as" style="padding: 10px; font-size: 0.95rem;" />
                        </div>
                        <div style="margin-bottom: 12px;">
                            <button class="btn" id="addRoutineDay" style="width: 100%; padding: 12px; min-height: 44px; font-size: 0.95rem;">
                                + A√±adir d√≠a
                            </button>
                        </div>
                        <div class="routine-days" id="routineDays"></div>
                        <div style="display: flex; gap: 8px; margin-top: 16px;">
                            <button class="btn" id="saveRoutine" style="flex: 1; padding: 12px; min-height: 44px; font-size: 0.95rem;">
                                Guardar rutina
                            </button>
                            <button class="btn btn--ghost" id="cancelRoutineBuilder" style="flex: 1; padding: 12px; min-height: 44px; font-size: 0.95rem;">
                                Cancelar
                            </button>
                        </div>
                    </article>
                    
                    <!-- Created Routines List -->
                    <article class="card pop" style="padding: 12px; margin-bottom: 12px;">
                        <h3 class="summary__title" style="margin: 0 0 10px 0; font-size: 1rem;">Rutinas creadas</h3>
                        <div id="createdRoutinesList" class="all-routines-list" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;"></div>
                        <div class="routine-empty" id="noCreatedRoutinesEmpty" style="text-align: center; padding: 30px 20px; color: var(--muted);">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">‚≠ê</div>
                            <div style="font-size: 1rem; font-weight: 600; margin-bottom: 5px; color: var(--text);">¬°Crea tu primera rutina!</div>
                            <div style="font-size: 0.85rem;">Pulsa el bot√≥n de arriba para empezar</div>
                        </div>
                    </article>
                    
                    <!-- Default Routines List -->
                    <article class="card pop" style="padding: 12px; margin-bottom: 12px;">
                        <h3 class="summary__title" style="margin: 0 0 10px 0; font-size: 1rem;">Rutinas por defecto</h3>
                        <div id="defaultRoutinesList" class="all-routines-list" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;"></div>
                    </article>
                    
                    <!-- Legacy lists (hidden, kept for functionality) -->
                    <div style="display: none;">
                        <div class="routine-created__list" id="createdRoutineList"></div>
                        <div class="routine-empty" id="noCreatedRoutines"></div>
                        <div class="routine-default__list" id="defaultRoutineList"></div>
                    </div>
                </div>
            </section>

            <!-- IMPORTAR -->
            <section class="panel import-panel" id="panel-import" role="tabpanel" aria-labelledby="tab-import" aria-hidden="true">
                <!-- Back Button -->
                <button class="btn btn--ghost" id="btnBackFromImport" style="margin-bottom: 16px; padding: 12px 16px; min-height: 44px; display: flex; align-items: center; gap: 8px;">
                    <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                        <path d="M19 12H5" />
                        <path d="M12 19l-7-7 7-7" />
                    </svg>
                    <span class="import-panel-text">Atr√°s</span>
                </button>
                <!-- Section 1: Import/Export Sessions -->
                <article class="card pop import-section" style="padding: 16px; margin-bottom: 16px;">
                    <h3 class="summary__title import-panel-title" style="margin: 0 0 12px 0; font-size: 1.1rem;">Importar / Exportar sesiones</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 16px;">
                        <button class="btn btn--ghost" onclick="document.getElementById('fileInput').click()" 
                            style="padding: 12px; min-height: 48px; font-size: 0.95rem; display: flex; flex-direction: column; align-items: center; gap: 6px;">
                            <span style="font-size: 1.5rem;">üìÑ</span>
                            <span>Importar sesiones</span>
                        </button>
                        <button class="btn btn--ghost" id="btnExport" 
                            style="padding: 12px; min-height: 48px; font-size: 0.95rem; display: flex; flex-direction: column; align-items: center; gap: 6px;">
                            <span style="font-size: 1.5rem;">üñ®Ô∏è</span>
                            <span>Exportar sesiones</span>
                        </button>
                    </div>
                    <input id="fileInput" type="file" accept="application/json,.json" style="display:none" />
                    <div class="field" style="margin-bottom: 12px;">
                        <label class="label" for="targetWeek" style="margin-bottom: 6px; font-size: 0.9rem;">üìÖ Semana</label>
                        <select id="targetWeek" class="input" style="padding: 10px; font-size: 0.95rem;"></select>
                    </div>
                    <div id="importAlert" class="toast toast--err hidden" role="alert" aria-live="assertive"></div>
                    <div id="importErrorList" class="import-error-list hidden"></div>
                    <div id="preview" class="card hidden" style="padding:10px; margin-bottom: 12px; background: var(--surface-2);">
                        <div style="font-weight: 600; margin-bottom: 6px; font-size: 0.9rem;">Vista previa:</div>
                        <ul id="previewList" style="margin:0; padding-left: 18px; list-style:disc; font-size: 0.9rem;"></ul>
                    </div>
                    <button class="btn" id="btnImport" style="width:100%; padding: 12px; font-size: 0.95rem; min-height: 44px;">
                        ‚úÖ Importar
                    </button>
                </article>

                <!-- Section 2: Saved Routines -->
                <article class="card pop" style="padding: 16px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px">
                        <h4 class="summary__title import-panel-title" style="margin:0; font-size: 1rem;">üìÅ Rutinas guardadas</h4>
                        <div style="display:flex; gap:6px; align-items:center">
                            <button class="btn btn--ghost" id="btnImportRoutines" style="padding: 6px 10px; font-size: 0.85rem; min-height: 36px;">
                                üì• Importar
                            </button>
                            <button class="btn btn--ghost" id="btnExportRoutines" style="padding: 6px 10px; font-size: 0.85rem; min-height: 36px;">
                                üì§ Exportar
                            </button>
                        </div>
                    </div>
                    <input id="routineFileInput" type="file" accept="application/json,.json" style="display:none" />
                    <div id="routineFileInputContainer" style="display:none; margin-bottom:16px">
                        <div id="routineImportAlert" class="toast toast--err hidden" role="alert" aria-live="assertive"></div>
                        <div id="routineImportErrorList" class="import-error-list hidden"></div>
                        <div id="routinePreview" class="card hidden" style="padding:12px; margin-bottom: 16px; background: var(--surface-2);">
                            <div class="import-panel-text" style="font-weight: 600; margin-bottom: 8px;">Vista previa:</div>
                            <ul id="routinePreviewList" class="import-panel-text" style="margin:0; padding-left: 20px; list-style:disc"></ul>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn" id="btnConfirmImportRoutines" style="flex: 1; padding: 14px; min-height: 48px;">‚úÖ Importar</button>
                            <button class="btn btn--ghost" id="btnCancelImportRoutines" style="flex: 1; padding: 14px; min-height: 48px;">‚úï Cancelar</button>
                        </div>
                    </div>
                    <div id="importRoutineList" class="routine-import__list"></div>
                    <div class="routine-empty" id="importRoutineEmpty" style="text-align: center; padding: 40px 20px; color: var(--muted);">
                        <div style="font-size: 3rem; margin-bottom: 12px;">üìù</div>
                        <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 8px; color: var(--text);">Crea tu primera rutina</div>
                        <div style="font-size: 0.9rem;">Ve a "Rutinas" para empezar</div>
                    </div>
                </article>
            </section>

            <!-- AJUSTES -->
            <section class="panel" id="panel-settings" role="tabpanel" aria-labelledby="tab-settings" aria-hidden="true">
                <!-- Men√∫ principal de ajustes -->
                <div class="settings-main" id="settingsMain">
                    <article class="card pop" style="padding:16px">
                        <h3 class="summary__title" style="margin-bottom:16px">Ajustes</h3>
                        <div class="settings-menu">
                            <button class="settings-menu-item" id="settingsThemeBtn">
                                <span>üé®</span>
                                <span>Tema</span>
                                <span>‚Üí</span>
                            </button>
                            <button class="settings-menu-item" id="settingsProfileBtn">
                                <span>üë§</span>
                                <span>Perfil</span>
                                <span>‚Üí</span>
                            </button>
                            <button class="settings-menu-item" id="settingsBodyTrackBtn">
                                <span>üìà‚Äã‚Äã</span>
                                <span>BodyTrack</span>
                                <span>‚Üí</span>
                            </button>
                            <button class="settings-menu-item" id="settingsInfoBtn">
                                <span>‚ÑπÔ∏è</span>
                                <span>Informaci√≥n</span>
                                <span>‚Üí</span>
                            </button>
                            <button class="settings-menu-item" id="settingsCreatorBtn">
                                <span>üë®üèº‚Äçüíª‚Äã</span>
                                <span>Creador</span>
                                <span>‚Üí</span>
                            </button>
                        </div>
                    </article>
                </div>

                <!-- Sub-panel de Tema -->
                <div class="settings-subpanel" id="settingsTheme" style="display:none">
                    <article class="card pop" style="padding:16px">
                        <div class="settings-header">
                            <button class="btn btn--ghost" id="backFromTheme" aria-label="Volver">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="summary__title" style="margin:0; flex:1">Tema</h3>
                        </div>

                        <div class="field" style="margin-top:20px">
                            <label class="label">Modo</label>
                            <div style="display:flex; gap:8px">
                                <button class="btn" id="themeDarkBtn" style="flex:1">üåô Oscuro</button>
                                <button class="btn btn--ghost" id="themeLightBtn" style="flex:1">‚òÄÔ∏è Claro</button>
                            </div>
                        </div>

                        <div class="field" style="margin-top:20px">
                            <label class="label">Color de botones</label>
                            <p style="color:var(--muted); font-size:0.85rem; margin-bottom:12px">El color seleccionado se aplicar√° a ambos temas</p>
                            <div class="color-swatches" id="colorSwatches"></div>
                        </div>
                    </article>
                </div>

                <!-- Sub-panel de Perfil -->
                <div class="settings-subpanel" id="settingsProfile" style="display:none">
                    <article class="card pop" style="padding:16px; margin-bottom:12px">
                        <div class="settings-header">
                            <button class="btn btn--ghost" id="backFromProfile" aria-label="Volver">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="summary__title" style="margin:0; flex:1">Perfil</h3>
                        </div>
                        <div id="profileLevelDisplay" style="margin-top:16px">
                            <!-- Se renderizar√° din√°micamente -->
                        </div>
                    </article>

                    <article class="card pop" style="padding:16px">
                        <h3 class="summary__title" style="margin-bottom:10px">Mi Perfil</h3>
                        <div class="profile-layout">
                            <div class="profile-avatar-wrapper">
                                <img id="profileAvatar" class="profile-avatar" alt="Avatar" src="" />
                                <div class="avatar-controls" style="display:grid; gap:10px; width:100%">
                                    <div style="display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:end">
                                        <div class="field" style="margin-bottom:0">
                                            <label class="label" for="avatarStyle">Estilo de avatar</label>
                                            <select id="avatarStyle" class="input">
                                                <option value="avataaars">Avataaars</option>
                                                <option value="pixel-art">Pixel Art</option>
                                                <option value="adventurer">Adventurer</option>
                                                <option value="big-smile">Big Smile</option>
                                                <option value="bottts">Bottts</option>
                                                <option value="fun-emoji">Fun Emoji</option>
                                                <option value="icons">Icons</option>
                                                <option value="identicon">Identicon</option>
                                                <option value="lorelei">Lorelei</option>
                                                <option value="micah">Micah</option>
                                                <option value="miniavs">Miniavs</option>
                                                <option value="notionists">Notionists</option>
                                                <option value="open-peeps">Open Peeps</option>
                                                <option value="personas">Personas</option>
                                                <option value="rings">Rings</option>
                                                <option value="shapes">Shapes</option>
                                                <option value="thumbs">Thumbs</option>
                                            </select>
                                        </div>
                                        <button type="button" class="btn btn--ghost" id="generateAvatar"
                                            style="white-space:nowrap">Generar nuevo avatar</button>
                                    </div>
                                    <label for="profilePhoto" style="width:100%">
                                        <input id="profilePhoto" type="file" accept="image/*" class="input"
                                            style="display:none" />
                                        <button type="button" class="btn btn--ghost" style="width:100%"
                                            onclick="document.getElementById('profilePhoto').click()">Subir foto
                                            propia</button>
                                    </label>
                                    <button type="button" class="btn btn--ghost btn--danger" id="removePhoto"
                                        style="display:none">Eliminar foto</button>
                                </div>
                            </div>
                            <div class="profile-form">
                                <div class="field"><label class="label" for="profileFirstName">Nombre</label><input
                                        id="profileFirstName" class="input" placeholder="Nombre" /></div>
                                <div class="field"><label class="label" for="profileLastName">Apellidos</label><input
                                        id="profileLastName" class="input" placeholder="Apellidos" /></div>
                                <button class="btn" id="saveProfile" type="button">Actualizar perfil</button>
                            </div>
                        </div>
                    </article>

                    <article class="card pop" style="padding:16px; margin-top:12px">
                        <h3 class="summary__title" style="margin-bottom:8px">Notas r√°pidas</h3>
                        <div class="notes-form">
                            <label class="label" for="noteText">Nueva nota (m√°x. 200 caracteres)</label>
                            <textarea id="noteText" class="input" maxlength="200"
                                placeholder="Escribe tu nota..."></textarea>
                            <button class="btn btn--secondary" id="addNote" type="button">Guardar nota</button>
                        </div>
                        <div class="notes-list" id="notesList"></div>
                        <div class="routine-empty" id="notesEmpty">A√∫n no hay notas.</div>
                    </article>
                </div>

                <!-- Sub-panel de BodyTrack -->
                <div class="settings-subpanel" id="settingsBodyTrack" style="display:none">
                    <article class="card pop" style="padding:16px; margin-bottom:12px">
                        <div class="settings-header">
                            <button class="btn btn--ghost" id="backFromBodyTrack" aria-label="Volver">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="summary__title" style="margin:0; flex:1">BodyTrack</h3>
                        </div>
                    </article>

                    <article class="card pop" style="padding:16px; margin-bottom:12px">
                        <h3 class="summary__title" style="margin-bottom:10px">Datos Corporales</h3>
                        <div class="profile-form">
                                <div class="field"><label class="label" for="profileHeight">Altura (cm)</label><input
                                        id="profileHeight" class="input" type="number" inputmode="decimal" min="0"
                                        step="0.1" placeholder="Ej. 178" /></div>
                                <div class="field"><label class="label" for="profileWeight">Peso actual (kg)</label><input
                                        id="profileWeight" class="input" type="number" inputmode="decimal" min="0"
                                        step="0.1" placeholder="Opcional" /></div>
                                <div class="field"><label class="label" for="profileBodyFat">% grasa actual</label><input
                                        id="profileBodyFat" class="input" type="number" inputmode="decimal" min="0"
                                        step="0.1" placeholder="Opcional" /></div>
                            <button class="btn" id="saveBodyTrack" type="button">Guardar datos</button>
                        </div>
                    </article>

                    <article class="card pop profile-history" style="padding:16px; margin-bottom:12px">
                        <h3 class="summary__title" style="margin-bottom:8px">Historial de peso y % grasa</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Peso (kg)</th>
                                    <th>% Grasa</th>
                                </tr>
                            </thead>
                            <tbody id="profileHistoryBody">
                                <tr>
                                    <td colspan="3" style="padding:8px">Sin registros a√∫n</td>
                                </tr>
                            </tbody>
                        </table>
                    </article>

                    <article class="card pop" style="padding:16px; margin-bottom:12px">
                        <h3 class="summary__title" style="margin-bottom:16px">Medidas Corporales</h3>
                        <div class="body-measurements-form"
                            style="display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; margin-bottom:16px">
                            <div class="field">
                                <label class="label" for="measurementArms">Brazos (cm)</label>
                                <input id="measurementArms" class="input" type="number" inputmode="decimal" min="0"
                                    step="0.1" placeholder="Ej. 35.5" />
                            </div>
                            <div class="field">
                                <label class="label" for="measurementChest">Pecho (cm)</label>
                                <input id="measurementChest" class="input" type="number" inputmode="decimal" min="0"
                                    step="0.1" placeholder="Ej. 100" />
                            </div>
                            <div class="field">
                                <label class="label" for="measurementWaist">Cintura (cm)</label>
                                <input id="measurementWaist" class="input" type="number" inputmode="decimal" min="0"
                                    step="0.1" placeholder="Ej. 80" />
                            </div>
                            <div class="field">
                                <label class="label" for="measurementHips">Caderas (cm)</label>
                                <input id="measurementHips" class="input" type="number" inputmode="decimal" min="0"
                                    step="0.1" placeholder="Ej. 95" />
                            </div>
                            <div class="field">
                                <label class="label" for="measurementLegs">Piernas (cm)</label>
                                <input id="measurementLegs" class="input" type="number" inputmode="decimal" min="0"
                                    step="0.1" placeholder="Ej. 60" />
                            </div>
                            <div class="field">
                                <label class="label" for="measurementCalves">Gemelos (cm)</label>
                                <input id="measurementCalves" class="input" type="number" inputmode="decimal" min="0"
                                    step="0.1" placeholder="Ej. 38" />
                            </div>
                            <button class="btn" id="saveBodyMeasurements" type="button" style="grid-column: 1 / -1;">Guardar
                                medidas</button>
                        </div>
                        <div class="body-measurements-history">
                            <h4 class="summary__title" style="margin-bottom:8px; font-size:1rem">Historial de medidas</h4>
                            <div style="overflow-x:auto">
                                <table style="width:100%; border-collapse:collapse; font-size:0.9rem">
                                    <thead>
                                        <tr>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Fecha</th>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Brazos</th>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Pecho</th>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Cintura</th>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Caderas</th>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Piernas</th>
                                            <th style="padding:8px; border-bottom:1px solid var(--border); text-align:left">
                                                Gemelos</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyMeasurementsHistoryBody">
                                        <tr>
                                            <td colspan="7" style="padding:8px; color:var(--muted)">Sin registros a√∫n</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </article>

                    <article class="card pop" style="padding:16px">
                        <h3 class="summary__title" style="margin-bottom:16px">Calculadora de TMB y Calor√≠as</h3>
                        <div class="bmr-calculator" style="display:grid; grid-template-columns: repeat(2, 1fr); gap:12px">
                            <div class="field">
                                <label class="label" for="bmrGender">Sexo</label>
                                <select id="bmrGender" class="input">
                                    <option value="male">Hombre</option>
                                    <option value="female">Mujer</option>
                                </select>
                            </div>
                            <div class="field">
                                <label class="label" for="bmrAge">Edad</label>
                                <input id="bmrAge" class="input" type="number" min="1" max="120" placeholder="Ej. 30" />
                            </div>
                            <div class="field">
                                <label class="label" for="bmrActivity">Nivel de actividad</label>
                                <select id="bmrActivity" class="input">
                                    <option value="1.2">Sedentario (poco o ning√∫n ejercicio)</option>
                                    <option value="1.375">Ligera (ejercicio 1-3 d√≠as/semana)</option>
                                    <option value="1.55">Moderada (ejercicio 3-5 d√≠as/semana)</option>
                                    <option value="1.725">Intensa (ejercicio 6-7 d√≠as/semana)</option>
                                    <option value="1.9">Muy intensa (ejercicio 2 veces/d√≠a)</option>
                                </select>
                            </div>
                            <div class="field">
                                <label class="label" for="bmrGoal">Objetivo</label>
                                <select id="bmrGoal" class="input">
                                    <option value="maintain">Mantener peso</option>
                                    <option value="lose">Perder grasa</option>
                                    <option value="gain">Ganar masa muscular</option>
                                </select>
                            </div>
                            <button class="btn" id="calculateBMR" type="button"
                                style="grid-column: 1 / -1;">Calcular</button>
                        </div>
                        <div id="bmrResults"
                            style="margin-top:20px; padding:16px; background:var(--bg-secondary); border-radius:8px; display:none">
                            <h4 class="summary__title" style="margin-bottom:12px; font-size:1rem">Resultados</h4>
                            <div style="display:grid; gap:8px">
                                <div><strong>TMB (Tasa Metab√≥lica Basal):</strong> <span id="bmrValue">‚Äî</span> kcal/d√≠a
                                </div>
                                <div><strong>TDEE (Gasto Energ√©tico Total):</strong> <span id="tdeeValue">‚Äî</span> kcal/d√≠a
                                </div>
                                <div style="margin-top:8px; padding-top:8px; border-top:1px solid var(--border)">
                                    <strong>Calor√≠as recomendadas:</strong>
                                    <div style="margin-top:4px; color:var(--accent)" id="recommendedCalories">‚Äî</div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>

                <!-- Sub-panel de Informaci√≥n -->
                <div class="settings-subpanel" id="settingsInfo" style="display:none">
                    <article class="card pop" style="padding:16px">
                        <div class="settings-header">
                            <button class="btn btn--ghost" id="backFromInfo" aria-label="Volver">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="summary__title" style="margin:0; flex:1">Informaci√≥n</h3>
                        </div>
                        <button class="btn" id="btnManual" style="width:100%; margin-top:20px">‚ÑπÔ∏è Abrir Manual de Usuario</button>
                    </article>
                </div>

                <!-- Sub-panel de Creador -->
                <div class="settings-subpanel" id="settingsCreator" style="display:none">
                    <article class="card pop" style="padding:16px">
                        <div class="settings-header">
                            <button class="btn btn--ghost" id="backFromCreator" aria-label="Volver">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </button>
                            <h3 class="summary__title" style="margin:0; flex:1">Creador</h3>
                        </div>
                        <div style="margin-top:20px; text-align:center; display:flex; flex-direction:column; gap:16px; align-items:center;">
                            <div style="font-size:3rem; margin-bottom:8px;">üèÉüèº‚Äç‚ôÇÔ∏è‚Äç‚û°Ô∏è‚Äã‚Äã</div>
                            <p style="color:var(--text); font-size:1rem; line-height:1.6; margin:0;">
                                ¬°Hola! Soy F.Sanz el creador de EasyTracker. Si te gusta esta aplicaci√≥n y te est√° siendo √∫til, 
                                te agradecer√≠a mucho si pudieras darme una ‚≠ê estrella en GitHub.
                            </p>
                            <a href="https://github.com/fsanztor01/EasyTracker" 
                               target="_blank" 
                               rel="noopener noreferrer"
                               style="display:inline-flex; align-items:center; gap:8px; padding:12px 20px; background:var(--accent, #0A84FF); color:#FFFFFF; border-radius:8px; text-decoration:none; font-weight:600; transition:opacity 0.2s;"
                               onmouseover="this.style.opacity='0.9'" 
                               onmouseout="this.style.opacity='1'">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                                </svg>
                                <span>Ver en GitHub</span>
                            </a>
                            <p style="color:var(--muted); font-size:0.85rem; margin:0; line-height:1.5;">
                                Tu apoyo me ayuda a seguir mejorando la aplicaci√≥n. ¬°Gracias! üôè
                            </p>
                        </div>
                    </article>
                </div>
            </section>
        </main>

        <!-- BOTTOM NAV -->
        <nav class="bottom-nav" aria-label="Navegaci√≥n inferior">
            <button class="nav-btn" id="navDiary" aria-current="page" aria-label="Diario">
                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M4 19.5A2.5 2.5 0 0 0 6.5 22H20a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H6.5A2.5 2.5 0 0 0 4 4.5v15Z" />
                    <path d="M8 2v4" />
                    <path d="M16 2v4" />
                    <path d="M4 10h16" />
                    <path d="M8 14h8" />
                    <path d="M8 18h6" />
                </svg>
                <span>Entrenos</span>
            </button>
            <button class="nav-btn" id="navStats" aria-label="Progreso">
                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3v18h18" />
                    <path d="M13 17V9" />
                    <path d="M18 17V5" />
                    <path d="M8 17v-3" />
                </svg>
                <span>Progreso</span>
            </button>
            <button class="nav-btn" id="navRoutines" aria-label="Rutinas">
                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1" />
                    <path d="M9 14l2 2 4-4" />
                </svg>
                <span>Rutinas</span>
            </button>
            <button class="nav-btn" id="navSettings" aria-label="Ajustes">
                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z" />
                </svg>
                <span>Ajustes</span>
            </button>
        </nav>

        <!-- MODALES -->
        <dialog id="sessionDialog" aria-labelledby="sessionTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="sessionTitle">Nueva sesi√≥n</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div class="field"><label class="label" for="sessionName">Nombre</label><input id="sessionName"
                            class="input" placeholder="Ej. Pecho/Espalda" /></div>
                    <div class="field"><label class="label" for="sessionDate">Fecha</label><input id="sessionDate"
                            class="input" type="date" /></div>
                </div>
                <div class="modal__actions"><button class="btn btn--ghost" value="cancel">Cancelar</button><button
                        class="btn" id="saveSession" value="default">Guardar</button></div>
            </form>
        </dialog>

        <dialog id="editSessionDialog" aria-labelledby="editSessionTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="editSessionTitle">Editar sesi√≥n</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div class="field"><label class="label" for="editSessionName">Nombre</label><input
                            id="editSessionName" class="input" placeholder="Ej. Pecho/Espalda" /></div>
                    <div class="field"><label class="label" for="editSessionDate">Fecha</label><input
                            id="editSessionDate" class="input" type="date" /></div>
                </div>
                <div class="modal__actions"><button class="btn btn--ghost" value="cancel">Cancelar</button><button
                        class="btn" id="updateSession" value="default">Actualizar</button></div>
            </form>
        </dialog>

        <dialog id="exerciseDialog" aria-labelledby="exerciseTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="exerciseTitle">Nuevo ejercicio</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div class="field"><label class="label" for="exerciseName">Nombre del ejercicio</label><input
                            id="exerciseName" class="input" placeholder="Ej. Press banca" /></div>
                </div>
                <div class="modal__actions"><button class="btn btn--ghost" value="cancel">Cancelar</button><button
                        class="btn" id="saveExercise" value="default">Guardar</button></div>
            </form>
        </dialog>

        <dialog id="exerciseNoteDialog" aria-labelledby="exerciseNoteTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="exerciseNoteTitle">Nota del ejercicio</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div class="field">
                        <label class="label" for="exerciseNoteText">Nota (puedes usar saltos de l√≠nea)</label>
                        <textarea id="exerciseNoteText" class="input" rows="6"
                            placeholder="Escribe tu nota aqu√≠..."></textarea>
                    </div>
                </div>
                <div class="modal__actions">
                    <button class="btn btn--ghost" value="cancel">Cancelar</button>
                    <button class="btn btn--secondary" id="saveExerciseNote" value="default">Guardar</button>
                </div>
            </form>
        </dialog>

        <dialog id="confirmDialog" class="confirm-dialog" aria-labelledby="confirmTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="confirmTitle">Confirmar eliminaci√≥n</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <p class="confirm-message" id="confirmMessage">¬øEst√°s seguro de que quieres eliminar este elemento?
                    </p>
                </div>
                <div class="modal__actions">
                    <button class="btn btn--ghost" value="cancel">Cancelar</button>
                    <button class="btn" id="confirmDelete" value="default">Eliminar</button>
                </div>
            </form>
        </dialog>

        <dialog id="templateDialog" aria-labelledby="templateTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="templateTitle">Vista previa de plantilla</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div id="templatePreview" style="display:grid; gap:8px"></div>
                    <small style="color:var(--muted)">Se importar√° en la <strong>semana visible</strong> (pesta√±a
                        Diario).</small>
                </div>
                <div class="modal__actions">
                    <button class="btn btn--ghost" value="cancel">Cancelar</button>
                    <button class="btn btn--secondary" id="confirmTemplate">Importar en esta semana</button>
                </div>
            </form>
        </dialog>

        <dialog id="routineImportWeekDialog" aria-labelledby="routineImportWeekTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="routineImportWeekTitle">Seleccionar semana</h3>
                    <button type="button" class="theme-btn" value="cancel" aria-label="Cerrar" onclick="this.closest('dialog').close()">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div class="field">
                        <label class="label" for="routineImportWeek">Semana</label>
                        <select id="routineImportWeek" class="input" style="padding: 10px; font-size: 0.95rem;"></select>
                    </div>
                </div>
                <div class="modal__actions">
                    <button class="btn btn--ghost" value="cancel">Cancelar</button>
                    <button class="btn" id="confirmRoutineImportWeek" value="default">Importar</button>
                </div>
            </form>
        </dialog>

        <dialog id="restTimerDialog" aria-labelledby="restTimerTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="restTimerTitle">Temporizador de descanso</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div class="timer-selection" id="timerSelection">
                        <p style="text-align:center; margin-bottom:16px; color:var(--muted)">Selecciona el tiempo de
                            descanso:</p>
                        <div class="timer-buttons">
                            <button type="button" class="btn btn--ghost timer-btn" data-minutes="1">1 min</button>
                            <button type="button" class="btn btn--ghost timer-btn" data-minutes="2">2 min</button>
                            <button type="button" class="btn btn--ghost timer-btn" data-minutes="3">3 min</button>
                            <button type="button" class="btn btn--ghost timer-btn" data-minutes="4">4 min</button>
                        </div>
                    </div>
                    <div class="timer-running" id="timerRunning" style="display:none">
                        <div class="timer-display">
                            <div class="timer-time" id="timerTime">00:00</div>
                            <div class="timer-label">Tiempo restante</div>
                        </div>
                    </div>
                    <div class="timer-completed" id="timerCompleted" style="display:none">
                        <div class="timer-completed-content">
                            <div class="timer-checkmark">‚úì</div>
                            <div class="timer-completed-message">Descanso finalizado</div>
                        </div>
                    </div>
                </div>
                <div class="modal__actions">
                    <button class="btn btn--ghost" value="cancel" id="timerCancel"
                        style="display:none">Cancelar</button>
                </div>
            </form>
                </dialog>

                <dialog id="manualDialog" aria-labelledby="manualTitle" aria-modal="true">
                    <form method="dialog">
                        <div class="modal__head">
                            <h3 class="modal__title" id="manualTitle">Manual de Usuario - EasyTracker</h3>
                            <button class="theme-btn" value="cancel" aria-label="Cerrar">‚úï</button>
                        </div>
                        <div class="modal__body">
                            <div class="manual-content">
                                <div class="manual-section">
                                    <h2>üìã Tabla de Contenidos</h2>
                                    <div class="manual-toc">
                                        <ul>
                                            <li><a href="#inicio">Inicio</a></li>
                                            <li><a href="#diario">Diario de Entrenamientos</a></li>
                                            <li><a href="#estadisticas">Estad√≠sticas</a></li>
                                            <li><a href="#rutinas">Rutinas</a></li>
                                            <li><a href="#importar">Importar/Exportar</a></li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="manual-section" id="inicio">
                                    <h2>üèãÔ∏è‚Äç‚ôÇÔ∏è Inicio</h2>
                                    <h3>¬øQu√© es EasyTracker?</h3>
                                    <p>EasyTracker es una aplicaci√≥n web para registrar y analizar tus entrenamientos,
                                        ayud√°ndote a
                                        mejorar tu progreso y alcanzar tus metas.</p>

                                    <h3>Navegaci√≥n</h3>
                                    <ul>
                                        <li><strong>Navegaci√≥n inferior:</strong> Acceso r√°pido a Diario, Estad√≠sticas, Rutinas e
                                            Importar
                                        </li>
                                        <li><strong>Ajustes:</strong> Bot√≥n de engranaje en la esquina superior derecha para acceder a Tema, Perfil e Informaci√≥n</li>
                                    </ul>
                                </div>

                                <div class="manual-section" id="diario">
                                    <h2>üìù Diario</h2>
                                    <h3>Crear una sesi√≥n</h3>
                                    <ul>
                                        <li>Pulsa "+ Nueva sesi√≥n"</li>
                                        <li>Ingresa el nombre (ej: "Pecho y tr√≠ceps")</li>
                                        <li>Selecciona la fecha</li>
                                        <li>Pulsa "Guardar"</li>
                                    </ul>

                                    <h3>A√±adir ejercicios</h3>
                                    <ul>
                                        <li>Dentro de una sesi√≥n, pulsa "+ Ejercicio" en cualquier momento</li>
                                        <li>No necesitas activar ning√∫n modo de edici√≥n</li>
                                        <li>Ingresa el nombre del ejercicio y pulsa "Guardar"</li>
                                    </ul>

                                    <h3>Registrar sets</h3>
                                    <p>Para cada ejercicio, puedes a√±adir:</p>
                                    <ul>
                                        <li><strong>KG:</strong> Peso levantado</li>
                                        <li><strong>Reps:</strong> Repeticiones realizadas</li>
                                        <li><strong>RIR:</strong> Repeticiones en reserva (esfuerzo percibido)</li>
                                    </ul>

                                    <h3>Temporizador de descanso</h3>
                                    <ul>
                                        <li>Pulsa el bot√≥n ‚è≥ junto a cada set para activar el temporizador</li>
                                        <li>En m√≥vil, aparecer√° una ventana flotante centrada en la pantalla</li>
                                        <li>Cuando termine el tiempo, ver√°s un mensaje de confirmaci√≥n y se cerrar√°
                                            autom√°ticamente</li>
                                    </ul>
                                </div>

                                <div class="manual-section" id="estadisticas">
                                    <h2>üìä Estad√≠sticas</h2>
                                    <h3>Ver tu progreso</h3>
                                    <ul>
                                        <li>Ve a la pesta√±a "Estad√≠sticas"</li>
                                        <li>Selecciona la m√©trica que quieres analizar:
                                            <ul>
                                                <li>Volumen total</li>
                                                <li>RIR promedio</li>
                                                <li>Peso m√°ximo</li>
                                            </ul>
                                        </li>
                                        <li>Filtra por ejercicio espec√≠fico o "Todos los ejercicios"</li>
                                        <li>Elige el per√≠odo a analizar</li>
                                    </ul>
                                </div>

                                <div class="manual-section" id="rutinas">
                                    <h2>üß© Rutinas</h2>
                                    <h3>Crear rutina personalizada</h3>
                                    <ul>
                                        <li>Ve a la pesta√±a "Rutinas"</li>
                                        <li>Ingresa un nombre para tu rutina</li>
                                        <li>Pulsa "+ A√±adir d√≠a" para cada d√≠a de entrenamiento</li>
                                        <li>Para cada d√≠a:
                                            <ul>
                                                <li>Asigna un nombre (ej: "D√≠a 1 - Pecho")</li>
                                                <li>A√±ade ejercicios con "+ Ejercicio"</li>
                                                <li>Configura sets para cada ejercicio</li>
                                            </ul>
                                        </li>
                                        <li>Pulsa "Guardar rutina"</li>
                                    </ul>
                                </div>

                                <div class="manual-section" id="importar">
                                    <h2>üì• Importar/Exportar</h2>
                                    <h3>Importar entrenamientos</h3>
                                    <ul>
                                        <li>Ve a la pesta√±a "Importar"</li>
                                        <li>Selecciona la semana objetivo</li>
                                        <li>Elige un archivo JSON v√°lido</li>
                                        <li>Revisa la vista previa</li>
                                        <li>Pulsa "Importar"</li>
                                    </ul>

                                    <h3>Exportar datos</h3>
                                    <p>Puedes exportar tus datos en formato JSON:</p>
                                    <ul>
                                        <li><strong>Exportar sesiones:</strong> Pulsa "Exportar sesiones" en la secci√≥n
                                            "Importar
                                            entrenamientos" para descargar todos tus entrenamientos registrados.</li>
                                        <li><strong>Exportar rutinas:</strong> En la secci√≥n "Rutinas creadas", pulsa "üì§
                                            Exportar
                                            rutinas" para descargar todas tus rutinas personalizadas creadas.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="modal__actions">
                            <button class="btn" value="cancel">Cerrar</button>
                        </div>
                    </form>
                </dialog>

        <!-- Week Info Dialog -->
        <dialog id="weekInfoDialog" aria-labelledby="weekInfoTitle" aria-modal="true">
            <form method="dialog">
                <div class="modal__head">
                    <h3 class="modal__title" id="weekInfoTitle">Informaci√≥n de Semanas</h3>
                    <button class="theme-btn" value="cancel" aria-label="Cerrar">Cerrar</button>
                </div>
                <div class="modal__body">
                    <div id="weekInfoContent"></div>
                </div>
                <div class="modal__actions">
                    <button class="btn" value="cancel">Cerrar</button>
                </div>
            </form>
        </dialog>

                <!-- Templates -->
        <template id="tpl-session">
            <article class="session card pop" data-id="">
                <div class="session__header">
                    <div class="session__titlewrap">
                        <div class="session__title"></div>
                        <div class="session__date"></div>
                        <div class="session__changes-indicator" style="display:none">
                            <span>‚ö†Ô∏è</span>
                            <span>Cambios sin guardar</span>
                        </div>
                    </div>
                    <div class="session__tools">
                        <button class="btn btn--mobile btn--ghost js-complete" title="Marcar como completada"
                            aria-pressed="false" aria-label="Marcar como completada">‚úì</button>
                        <button class="btn btn--mobile btn--ghost js-edit-session"
                            title="Editar nombre y fecha de la sesi√≥n"
                            aria-label="Editar nombre y fecha de la sesi√≥n">‚úèÔ∏è</button>
                        <button class="btn btn--mobile btn--ghost js-add-ex" title="A√±adir ejercicio"
                            aria-label="A√±adir ejercicio">+
                            Ejercicio</button>
                        <button class="btn btn--mobile btn--ghost js-delete" title="Eliminar sesi√≥n"
                            aria-label="Eliminar sesi√≥n">‚úï</button>
                    </div>
                    <div class="session__edit-controls" style="display:none">
                        <button class="btn btn--small js-save-session">üíæ Guardar cambios</button>
                        <button class="btn btn--small btn--ghost js-cancel-session">‚úï Cancelar</button>
                    </div>
                </div>
                <div class="session__body"></div>
            </article>
        </template>

        <template id="tpl-exercise">
            <section class="exercise" data-ex-id="">
                <div class="exercise__head">
                    <div class="exercise__name"></div>
                    <div>
                        <button class="btn btn--small btn--ghost js-add-set">+ Set</button>
                        <button class="btn btn--small btn--ghost js-del-ex"
                            style="border:1px solid var(--border)">‚úï</button>
                    </div>
                </div>
                <!-- Mobile cards container -->
                <div class="sets-container"></div>
                <!-- Desktop table container -->
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Set</th>
                                <th>KG</th>
                                <th>Reps</th>
                                <th>RIR</th>
                                <th>Progreso</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody class="sets"></tbody>
                    </table>
                </div>
            </section>
        </template>

        <template id="tpl-set">
            <tr data-set-id="">
                <td class="set-num"></td>
                <td style="position:relative">
                    <input class="input js-kg" inputmode="decimal" aria-label="Kilogramos" />
                    <div class="prev-week-data prev-week-kg" style="display:none"></div>
                </td>
                <td style="position:relative">
                    <input class="input js-reps" inputmode="numeric" aria-label="Repeticiones"
                        placeholder="6, 6+1 o 6-8" />
                    <div class="prev-week-data prev-week-reps" style="display:none"></div>
                </td>
                <td style="position:relative">
                    <input class="input js-rir" inputmode="decimal" aria-label="RIR" placeholder="1 o 1/0" />
                    <div class="prev-week-data prev-week-rir" style="display:none"></div>
                </td>
                <td class="progress">Primera sesi√≥n</td>
                <td>
                    <button class="btn btn--ghost btn--timer js-rest-timer" aria-label="Temporizador de descanso"
                        title="Temporizador de descanso">‚è≥</button>
                    <button class="btn btn--ghost btn--prev-week js-prev-week-data"
                        aria-label="Ver datos de la semana pasada" title="Ver datos de la semana pasada">üëÅÔ∏è</button>
                    <button class="btn btn--ghost js-del-set" aria-label="Eliminar set">‚úï</button>
                </td>
            </tr>
        </template>

        <!-- Mobile set card template -->
        <template id="tpl-set-card">
            <div class="set-card" data-set-id="">
                <div class="set-header">
                    <div class="set-number">Set 1</div>
                    <div class="set-header-actions">
                        <button class="btn btn--ghost btn--timer btn--small js-rest-timer"
                            aria-label="Temporizador de descanso" title="Temporizador de descanso">‚è≥</button>
                        <button class="btn btn--ghost btn--prev-week btn--small js-prev-week-data"
                            aria-label="Ver datos de la semana pasada"
                            title="Ver datos de la semana pasada">üëÅÔ∏è</button>
                        <button class="set-delete js-del-set" aria-label="Eliminar set">‚úï</button>
                    </div>
                </div>
                <div class="set-inputs">
                    <div class="set-input-group" style="position:relative">
                        <label class="set-input-label">KG</label>
                        <input class="set-input js-kg" inputmode="decimal" aria-label="Kilogramos" placeholder="0" />
                        <div class="prev-week-data prev-week-kg" style="display:none"></div>
                    </div>
                    <div class="set-input-group" style="position:relative">
                        <label class="set-input-label">Reps</label>
                        <input class="set-input js-reps" inputmode="numeric" aria-label="Repeticiones"
                            placeholder="0" />
                        <div class="prev-week-data prev-week-reps" style="display:none"></div>
                    </div>
                    <div class="set-input-group" style="position:relative">
                        <label class="set-input-label">RIR</label>
                        <input class="set-input js-rir" inputmode="decimal" aria-label="RIR" placeholder="0" />
                        <div class="prev-week-data prev-week-rir" style="display:none"></div>
                    </div>
                </div>
                <div class="set-progress">Primera sesi√≥n</div>
            </div>
        </template>

        <template id="tpl-routine-day">
            <div class="routine-day" data-day-id="">
                <div class="routine-day__head">
                    <div class="routine-day__title">D√≠a</div>
                    <input class="input routine-day__name" placeholder="Nombre del d√≠a (ej. Pecho/Espalda)" />
                    <div>
                        <button class="btn btn--small btn--ghost js-add-routine-exercise">+ Ejercicio</button>
                        <button class="btn btn--small btn--ghost js-delete-routine-day"
                            aria-label="Eliminar d√≠a">‚úï</button>
                    </div>
                </div>
                <div class="routine-exercises"></div>
            </div>
        </template>

        <template id="tpl-routine-exercise">
            <div class="routine-exercise" data-ex-id="">
                <div class="routine-exercise__head">
                    <input class="input routine-exercise__name" placeholder="Nombre del ejercicio" />
                    <div>
                        <button class="btn btn--small btn--ghost js-add-routine-set">+ Set</button>
                        <button class="btn btn--small btn--ghost js-delete-routine-exercise"
                            aria-label="Eliminar ejercicio">‚úï</button>
                    </div>
                </div>
                <div class="routine-sets"></div>
            </div>
        </template>

        <template id="tpl-routine-set">
            <div class="routine-set" data-set-id="">
                <span class="routine-set__index">Set</span>
                <input class="input routine-set__kg" inputmode="decimal" placeholder="KG" aria-label="Kilogramos" />
                <input class="input routine-set__reps" inputmode="numeric" placeholder="Reps"
                    aria-label="Repeticiones" />
                <input class="input routine-set__rir" inputmode="decimal" placeholder="RIR" aria-label="RIR" />
                <button class="btn btn--small btn--ghost js-delete-routine-set" aria-label="Eliminar set">‚úï</button>
            </div>
        </template>

        <!-- TOASTS -->
        <div class="toasts" id="toasts" aria-live="polite" aria-atomic="true"></div>

        </main>
    </div>

    <!-- Main Application -->
    <!-- Utils (Critical - Load First) -->
    <script src="js/utils/dom.js"></script>
    <script src="js/utils/uuid.js"></script>
    <script src="js/utils/dates.js"></script>
    <script src="js/utils/calculations.js"></script>
    <script src="js/utils/theme.js"></script>
    <script src="js/utils/toast.js"></script>
    <!-- Config -->
    <script src="js/config/app-state.js"></script>
    <script src="js/config/templates.js"></script>
    <!-- Storage -->
    <script src="js/utils/storage.js"></script>
    <!-- Modules (Lazy Load - Load on demand) -->
    <!-- Main App -->
    <script src="js/app.js"></script>

</body>

</html>

